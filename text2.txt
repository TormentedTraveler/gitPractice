changes by esen

(changes by tormented)

some (handle error)  additional changes
